# 基于日志文件的众包移动应用测试报告生成框架的设计与实现
为了解决众包测试中高质量软件测试报告产出困难的问题，本文提出的基于日志文件的众包移动应用测试报告生成框架，基于相邻时间差和FP-growth算法对Android众包测试中产生的系统数据（event数据）进行切分，利用层次聚类算法结合logcat日志进行聚类建模，设计5种优先级不同的测试序列类别，提取重点设计翻译模版并结合翻译库进行测试序列翻译，自动化生成高质量的软件测试报告，促进众包软件测试的发展，保证Android应用的质量。

为了更好的展示实验结果，本课题同步搭建了实验展示平台，用于更直观的展示实验的各个步骤和结果。实验展示平台的前端展示通过Vue.js框架实现，后端通过python FLASK框架实现，服务器搭建在阿里云服务器中，访问地址为：http://59.110.152.105:3000 。

## 1 框架组成结构
![avatar](http://59.110.152.105/S-CAT-thestruct.png)

## 2 数据预处理
数据来自众包Android测试平台，例如kikBug平台。数据主要来自三个应用，SE-1800，UBOOK和iShopping。在移动应用众包软件测试的背景下，一方面由于各个众包测试人员年龄，测试知识不同，其测试行为习惯也不同，在众包测试的过程中会出现一些冗余数据。例如，在众包测试人员测试时，由于可能产生的重复测试动作，从而生成多个重复测试文件导致原始数据冗余。另一方面，由于测试数据未整理，多个应用的系统数据文件掺杂在一起没有分开，原始数据集冗余度和复杂度过高，难以便于分析，为了保证实验的准确性，本框架首先对原始数据进行数据预处理。
数据预处理由三部分组成，分别是数据去重和拼接，数据整合和数据筛选。
![avatar](http://59.110.152.105/S-CAT-wash.png)

在数据预处理展示模块，访问http://59.110.152.105:3000/init进行查看 ，在界面左侧可以直观地看到原始数据文件夹logcat文件夹和event文件夹，通过点击原始数据文件夹中的文件可以访问和查看目标文件的内容。

## 3 合理序列切分
由于原数据集中每个日志文件的数据量较大，同时为了便于针对性对测试数据进行分析，决定对原日志文件进行序列切分，将全部众包测试人员的测试event日志文件切分成一条条合适长度的测试event序列。
合理序列切分由两部分组成：基于相邻event时间差的中等长度event序列的切分 和 基于FP-growth明显event类型的小长度序列切分
![avatar](http://59.110.152.105/S-CAT-slice.png)

在序列合理切分展示模块，访问http://59.110.152.105:3000/preprocess 进行查看。在界面左面可以直观地看到经过预处理后分类的日志数据，通过点击每个应用包文件夹的不同众包测试人员的日志文件，可以看到结构比较清晰的预处理后的日志文件。


## 4 聚类建模
结合logcat数据中的Error,Warning,Debug等日志标签，先对logcat日志标签数据进行聚类，然后根据时间戳进行对应事件序列聚类。
经过比对得知，其中的“priority”，“tag”，“SyscTime”，“message”可作为区分不同类的logcat数据的属性，以Error为例，取所有“priority”为“E”的110条logcat日志，以“tag”标签作为评判依据，以“message”标签作为聚类特征，使用字符串编辑距离（莱文斯坦距离）算法计算相似每个logcat日志之间的距离，得到关于Error类的110*110的相似度矩阵。将得到的相似度矩阵采用层次聚类算法进行聚类。

## 5 序列分类
为了有效的挖掘众包测试人员在测试过程中可能存在的Bug，本框架对已经切分好的事件序列进行分类，设计了五类优先级各不相同的事件序列：Confirmed Bug事件序列，High risk Bug事件序列，Suspected Bug事件序列，Suspected test actions事件序列，Normal test actions事件序列。

在序列分类展示模块，访问http://59.110.152.105:3000/slice 进行查看，在界面左侧可以直观地看到每个应用文件夹下的每位众包测试人员的文件，通过点击每个应用包文件夹的不同众包测试人员的日志文件，可以看到结构清晰的已切分事件序列，

## 6 翻译生成报告
建立了翻译模版和若干翻译库，完整翻译模版描述了测试动作发生的时间，结束的时间，序列的类别和测试动作从开始进入应用程序后的详细描述，概括翻译模版概括描述了测试发生的时间段和部分测试动作。

![avatar](http://59.110.152.105/S-CAT-generate.png)

在翻译生成报告展示模块，访问http://59.110.152.105:3000/summary 进行查看，在界面右侧根据已经过切分和标注的序列结合翻译模版进行翻译，生成一份层次感清晰的翻译报告。
